# –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ —Å—Ç–∞–∂–∏—Ä–æ–≤–∫—É –¥–ª—è ViCueSoft
[![ViCue Soft](https://scontent-hel3-1.xx.fbcdn.net/v/t1.6435-9/100049479_576904839469133_78457503330861056_n.png?_nc_cat=108&ccb=1-5&_nc_sid=973b4a&_nc_ohc=oohtigKncVMAX83Tktk&_nc_ht=scontent-hel3-1.xx&oh=e921e9bcb526f8659fd137b763d0ea50&oe=61D2C460)](https://vicuesoft.com/)

–¢–µ—Å—Ç–æ–≤–æ–µ –∑–∞–¥–∞–Ω–∏–µ –¥–ª—è —Å—Ç–∞–∂–∏—Ä–æ–≤–∫–∏ –≤ –∫–æ–º–ø–∞–Ω–∏–∏ ViCueSoft

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ
–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ PSNR. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –≤—ã–≤–æ–¥–∏—Ç—å –≤ —Ñ–∞–π–ª –∑–Ω–∞—á–µ–Ω–∏–µ PSNR –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ñ—Ä–µ–π–º–∞, –∞ —Ç–∞–∫–∂–µ —Å—Ä–µ–¥–Ω–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ PSNR –≤ –∫–æ–Ω—Ü–µ —Ä–∞–±–æ—Ç—ã —Å –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–º. –†–∞—Å—á–∏—Ç–∞—Ç—å —Å—Ä–µ–¥–Ω–µ–µ PSNR –¥–ª—è 5 –∑–Ω–∞—á–µ–Ω–∏–π —Ä–∞–∑–Ω—ã—Ö –±–∏—Ç—Ä–µ–π—Ç–æ–≤ (1000-5000 kbps). –ü–æ—Å—Ç—Ä–æ–∏—Ç—å –≥—Ä–∞—Ñ–∏–∫ Rate-Distortion (RD). 

## –ú–µ—Ç—Ä–∏–∫–∞ PSNR
–ü–∏–∫–æ–≤–æ–µ –æ—Ç–Ω–æ—à–µ–Ω–∏–µ —Å–∏–≥–Ω–∞–ª–∞ –∫ —à—É–º—É (–∞–Ω–≥–ª. peak signal-to-noise ratio) –æ–±–æ–∑–Ω–∞—á–∞–µ—Ç—Å—è –∞–±–±—Ä–µ–≤–∏–∞—Ç—É—Ä–æ–π [PSNR](https://ru.wikipedia.org/wiki/%D0%9F%D0%B8%D0%BA%D0%BE%D0%B2%D0%BE%D0%B5_%D0%BE%D1%82%D0%BD%D0%BE%D1%88%D0%B5%D0%BD%D0%B8%D0%B5_%D1%81%D0%B8%D0%B3%D0%BD%D0%B0%D0%BB%D0%B0_%D0%BA_%D1%88%D1%83%D0%BC%D1%83)  –∏ —è–≤–ª—è–µ—Ç—Å—è –∏–Ω–∂–µ–Ω–µ—Ä–Ω—ã–º —Ç–µ—Ä–º–∏–Ω–æ–º, –æ–∑–Ω–∞—á–∞—é—â–∏–º —Å–æ–æ—Ç–Ω–æ—à–µ–Ω–∏–µ –º–µ–∂–¥—É –º–∞–∫—Å–∏–º—É–º–æ–º –≤–æ–∑–º–æ–∂–Ω–æ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞ –∏ –º–æ—â–Ω–æ—Å—Ç—å—é —à—É–º–∞, –∏—Å–∫–∞–∂–∞—é—â–µ–≥–æ –∑–Ω–∞—á–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞. –ü–æ—Å–∫–æ–ª—å–∫—É –º–Ω–æ–≥–∏–µ —Å–∏–≥–Ω–∞–ª—ã –∏–º–µ—é—Ç —à–∏—Ä–æ–∫–∏–π –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π –¥–∏–∞–ø–∞–∑–æ–Ω, PSNR –æ–±—ã—á–Ω–æ –∏–∑–º–µ—Ä—è–µ—Ç—Å—è –≤ –ª–æ–≥–∞—Ä–∏—Ñ–º–∏—á–µ—Å–∫–æ–π —à–∫–∞–ª–µ –≤ –¥–µ—Ü–∏–±–µ–ª–∞—Ö.

PSNR –Ω–∞–∏–±–æ–ª–µ–µ —á–∞—Å—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è —É—Ä–æ–≤–Ω—è –∏—Å–∫–∞–∂–µ–Ω–∏–π –ø—Ä–∏ —Å–∂–∞—Ç–∏–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π. –ü—Ä–æ—â–µ –≤—Å–µ–≥–æ –µ–≥–æ –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å —á–µ—Ä–µ–∑ —Å—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω—É—é –æ—à–∏–±–∫—É (–°–ö–û) –∏–ª–∏ MSE (–∞–Ω–≥–ª. mean square error).

## –ù–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –±–∏–±–∏–ª–∏–æ—Ç–µ–∫–∏ –∏ —Å–æ–¥–µ—Ä–∂–∞–Ω–∏–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è
–î–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –∫–æ–º–∞–Ω–¥ –ø—Ä–∏ –ø–æ–¥–≥–æ—Ç–æ–≤–∫–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ [FFmpeg](https://www.ffmpeg.org/download.html#build-linux). –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å Linux (Debian):
```
sudo apt install ffmpeg
```
–°–∞–º–∞ –ø—Ä–æ–≥—Ä–∞–º–º–∞ –Ω–∞–ø–∏—Å–∞–Ω–∞ —Ç–∞–∫, —á—Ç–æ–±—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç–æ—Ä–æ–Ω–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫. –ü–æ—ç—Ç–æ–º—É –µ–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω–æ–π —Å—Ç–æ—Ä–æ–Ω–Ω–∏–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–º —è–≤–ª—è–µ—Ç—Å—è —Ñ–∞–π–ª `stb_image.h`
–Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–π –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ([–∏—Å—Ç–æ—á–Ω–∏–∫](https://github.com/nothings/stb)).

–°–ø–∏—Å–æ–∫ —Ñ–∞–π–ª–æ–≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è:
- `stb_image.h` - —Ö–µ–¥–µ—Ä –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- `read_file.cpp` - –ø—Ä–æ–≥—Ä–∞–º–º–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ PSNR
- `Source` - –ø–∞–ø–∫–∞ —Å –∏—Å—Ö–æ–¥–Ω—ã–º –≤–∏–¥–µ–æ—Ñ–∞–π–ª–æ–º –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–æ–π
- `Test1k` - –ø–∞–ø–∫–∞ —Å —Å–∂–∞—Ç—ã–º/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∏–¥–µ–æ –ø–æ–¥ 1000 kbps –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞
- `Test2k` - –ø–∞–ø–∫–∞ —Å —Å–∂–∞—Ç—ã–º/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∏–¥–µ–æ –ø–æ–¥ 2000 kbps –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞
- `Test3k` - –ø–∞–ø–∫–∞ —Å —Å–∂–∞—Ç—ã–º/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∏–¥–µ–æ –ø–æ–¥ 3000 kbps –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞
- `Test4k` - –ø–∞–ø–∫–∞ —Å —Å–∂–∞—Ç—ã–º/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∏–¥–µ–æ –ø–æ–¥ 4000 kbps –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞
- `Test5k` - –ø–∞–ø–∫–∞ —Å —Å–∂–∞—Ç—ã–º/–¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–Ω—ã–º –≤–∏–¥–µ–æ –ø–æ–¥ 5000 kbps –∏ –µ–≥–æ —Ä–∞—Å–∫–∞–¥—Ä–æ–≤–∫–∞
- `CMakeLists.txt` - init Cmake
- `README.md` - –¥–æ–∫—Å—Ç—Ä–∏–Ω–≥–∏ –¥–ª—è —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

## –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
---

<div align="center">
  <h4>üí° –ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏, —Å–º–æ—Ç—Ä–∏—Ç–µ "–ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã". –ü–æ—Ä—è–¥–æ–∫ –¥–µ–π—Å—Ç–≤–∏–π –æ–ø–∏—Å–∞–Ω –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ–¥–Ω–æ–≥–æ –≤–∏–¥–µ–æ. –ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∞ –≤–∏–¥–µ–æ 2000, 3000, 4000, 5000 kbps –Ω—É–∂–Ω–æ –ø–æ–≤—Ç–æ—Ä–∏—Ç—å –ø—É–Ω–∫—Ç—ã 03 - 05 –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –±–∏—Ç—Ä–µ–π—Ç–æ–≤. üí°</h3>
</div>

---
- `01`: –° [—Å–∞–π—Ç–∞](https://media.xiph.org/video/derf/) –±—ã–ª —Å–∫–∞—á–µ–Ω –≤–∏–¥–µ–æ—Ä—è–¥ `waterfall_cif.y4m` (–¥–∞–ª–µ–µ `refFile`)
- `02`: –°–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤–∞—è –ø–∞–ø–∫–∞ –≤ –∫–æ—Ç–æ—Ä–æ–π –±—É–¥–µ—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è `refFile` –∏ –≤—ã–ø–æ–ª–Ω—è–µ—Ç—Å—è –∫–æ–º–∞–Ω–¥–∞, –¥–ª—è –ø–µ—Ä–µ–≤–æ–¥–∞ –≤–∏–¥–µ–æ –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ (–≤ –∫–∞—á–µ—Å—Ç–≤–µ –º–µ—Ä—ã –¥–ª—è –Ω–µ–±–æ–ª—å—à–æ–≥–æ —É—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –±—ã–ª–æ –ø—Ä–∏–Ω—è—Ç–æ —Ä–µ—à–µ–Ω–∏–µ –ø–µ—Ä–µ–≤–µ—Å—Ç–∏ –≤–∏–¥–µ–æ –≤ –æ—Ç—Ç–µ–Ω–∫–∏ —Å–µ—Ä–æ–≥–æ): 
```
ffmpeg -i waterfall_cif.y4m -vf format=gray waterfall_cif_grayscale.y4m'
```
- `03`: –î–ª—è —Å–∂–∞—Ç–∏—è —Ñ–∞–π–ª–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –±–∏—Ç—Ä–µ–π—Ç—Ä–∞—Ö –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å –∫–æ–º–∞–Ω–¥–∞. –ü—Ä–∏ —ç—Ç–æ–º —Ñ–∞–π–ª target_1000.mp4 –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç—Å—è –≤ –æ—Ç–¥–µ–ª—å–Ω—É—é –ø–∞–ø–∫—É:
```
ffmpeg -i waterfall_cif_grayscale.y4m -c:v libx264 -b:v 1M target_1000.mp4
```
(–¥–∞–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ —Å–æ–∑–¥–∞—Å—Ç –æ–¥–∏–Ω —Å–∂–∞—Ç—ã–π —Ñ–∞–π–ª –¥–ª—è –±–∏—Ç—Ä–µ–π—Ç–∞ 1000 kbps)
- `04`: –î–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∞—Å—å –∫–æ–º–∞–Ω–¥–∞:
```
ffmpeg -i target_1000.mp4 -f yuv4mpegpipe decoded_target_1000.y4m
```
- `05`: –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –≤–∏–¥–µ–æ—Ñ–∞–π–ª–∞ –ø–æ–ª—É—á–∞–µ–º –∏–∑ –Ω–µ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –¥–ª—è –ø–æ–¥—Å—á—ë—Ç–∞ PSNR
```
ffmpeg -i decoded_target_1000.y4m img%d.png
```
(—Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º —ç—Ç–æ–π –∫–æ–º–∞–Ω–¥—ã –±—É–¥—É—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è: img1.png, img2.png –∏ —Ç.–¥., –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –≤–∞–∂–Ω–æ —Å–æ–±–ª—é–¥–∞—Ç—å –∏–º–µ–Ω–Ω–æ —Ç–∞–∫—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –≤—ã–≤–æ–¥–∞)

## –ó–∞–ø—É—Å–∫ –ø—Ä–æ–≥—Ä–∞–º–º—ã
–¢.–∫. –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è —É–∂–µ –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –∏ –≤—Å–µ –∏—Å—Ö–æ–¥–Ω–∏–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π, —Ç–æ –¥–ª—è –∑–∞–ø—É—Å–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º—ã –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ç–æ–ª—å–∫–æ –∫–ª–æ–Ω–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ –≤—ã–±—Ä–∞—Ç—å –æ–¥–∏–Ω –∏–∑ —Å–ø–æ—Å–æ–±–æ–≤ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏ –∏ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ö–ª–æ–Ω–∏—Ä—É–µ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:
```
mkdir PSNRapp && cd PSNRapp
git clone https://github.com/Kr1eg3/test_for_ViCueSoft
cd test_for_ViCueSoft
```
–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —ç—Ç–∏—Ö –∫–æ–º–º–∞–Ω–¥ —Å–º–æ—Ç—Ä–∏—Ç–µ –æ–¥–∏–Ω –∏–∑ –ø—É–Ω–∫—Ç–æ–≤ –Ω–∏–∂–µ

## –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ —Å –ø–æ–º–æ—â—å—é CMake
```
cmake .
make
./app <Source Folder> <Test Folder> <Number of frames>
```

## –ö–æ–º–ø–∏–ª—è—Ü–∏—è –∏ –∑–∞–ø—É—Å–∫ –ø–æ–¥ Linux —Å –ø–æ–º–æ—â—å—é GCC
```
g++ read_file.cpp -o app
./app <Source Folder> <Test Folder> <Number of frames>
```

## Rate-Distortion plot
–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ —Ä–∞–±–æ—Ç—ã –ø—Ä–æ–≥—Ä–∞–º–º—ã –±—ã–ª–∏ –ø–æ–ª—É—á–µ–Ω–∞ –∏—Å–∫–æ–º–∞—è –º–µ—Ç—Ä–∏–∫–∞, –∫–æ—Ç–æ—Ä–∞—è –±—ã–ª–∞ —Å—Ä–∞–≤–Ω–µ–Ω–∞ —Å PSNR, —Ä–∞—Å—Å—á–∏—Ç–∞–Ω–æ–π —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–≥—Ä–∞–º–º—ã FFmpeg. –ê —Ç–∞–∫–∂–µ –±—ã–ª–∞ –ø–æ—Å—á–∏—Ç–∞–Ω–∞ –º–µ—Ç—Ä–∏–∫–∞ [SSIM](https://medium.com/srm-mic/all-about-structural-similarity-index-ssim-theory-code-in-pytorch-6551b455541e). –ö–æ–º–∞–Ω–¥–∞ –¥–ª—è —Ä–∞—Å—á—ë—Ç–∞ PSNR —á–µ—Ä–µ–∑ FFmpeg:
```
ffmpeg -i decoded_target_grayscale_1000.y4m -i waterfall_cif_grayscale.y4m -filter_complex "psnr" -f null /dev/null
```
![Graph](https://user-images.githubusercontent.com/50653532/144757796-2b5117e4-2831-4457-a45b-31bac1a3a80a.png)

